DROP PROCEDURE IF EXISTS sp_GetAdherentsCountForSect
GO

CREATE PROCEDURE sp_GetAdherentsCountForSect
	AS
	begin
	SELECT Sect.[name], COUNT(Adherent.adherent_id)
	FROM SectAdherent
	INNER JOIN Sect ON Sect.sect_id = SectAdherent.FK_sect_id
	INNER JOIN Adherent ON Adherent.adherent_id = SectAdherent.FK_adherent_id
	GROUP BY Sect.[name]
	end
GO

EXECUTE sp_GetAdherentsCountForSect
GO
